<html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>银联</title>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=0">
</head>
<body>
<p id="errmsg" style="color: red;"></p>
<form id="unionPayForm113" action="" method="post">
    <input name="version" type="hidden" value="">
    <input name="method" type="hidden" value="">
    <input name="partner" type="hidden" value="">
    <input name="banktype" type="hidden" value="">
    <input name="paymoney" type="hidden" value="">
    <input name="ordernumber" type="hidden" value="">
    <input name="callbackurl" type="hidden" value="">
    <input name="hrefbackurl" type="hidden" value="">
    <input name="attach" type="hidden" value="">
    <input name="sign" type="hidden" value="">
</form>
<form id="unionPayForm115" action="" method="post">
    <input name="merchantOutOrderNo" type="hidden" value="">
    <input name="merid" type="hidden" value="">
    <input name="noncestr" type="hidden" value="">
    <input name="notifyUrl" type="hidden" value="">
    <input name="orderMoney" type="hidden" value="">
    <input name="orderTime" type="hidden" value="">
    <input name="sign" type="hidden" value="">
    <input name="returnUrl" type="hidden" value="">
</form>
<form id="unionPayForm117" action="" method="post">
    <input name="pay_memberid" type="hidden" value="">
    <input name="pay_orderid" type="hidden" value="">
    <input name="pay_applydate" type="hidden" value="">
    <input name="pay_bankcode" type="hidden" value="">
    <input name="pay_notifyurl" type="hidden" value="">
    <input name="pay_callbackurl" type="hidden" value="">
    <input name="pay_amount" type="hidden" value="">
    <input name="pay_md5sign" type="hidden" value="">
    <input name="pay_productname" type="hidden" value="">
</form>
</body>
<script src="http://mobile.szmpyd.com/js/jquery.min.js"></script>
<script>
//提取并设置表单参数
var flag = false;
var url = location.href;
url = url.substring(url.indexOf("?") + 1);
var pccode = "";
if(url.indexOf('pccode=') > -1)
{
    var pccode = decodeURIComponent(url.match(new RegExp("(^|&)pccode=([^&]*)(&|$)"))[2]);
    var $form = $('#unionPayForm' + pccode);
    if(pccode == 113)
    {
        if(url.indexOf('version=') > -1 && url.indexOf('method=') > -1 && url.indexOf('partner=') > -1
            && url.indexOf('banktype=') > -1 && url.indexOf('paymoney=') > -1 && url.indexOf('ordernumber=') > -1
            && url.indexOf('callbackurl=') > -1 && url.indexOf('sign=') > -1 && url.indexOf('action=') > -1)
        {
            //设置必填表单参数
            flag = true;
            $form.find('input[name="version"]').val(decodeURIComponent(url.match(new RegExp("(^|&)version=([^&]*)(&|$)"))[2]));
            $form.find('input[name="method"]').val(decodeURIComponent(url.match(new RegExp("(^|&)method=([^&]*)(&|$)"))[2]));
            $form.find('input[name="partner"]').val(decodeURIComponent(url.match(new RegExp("(^|&)partner=([^&]*)(&|$)"))[2]));
            $form.find('input[name="banktype"]').val(decodeURIComponent(url.match(new RegExp("(^|&)banktype=([^&]*)(&|$)"))[2]));
            $form.find('input[name="paymoney"]').val(decodeURIComponent(url.match(new RegExp("(^|&)paymoney=([^&]*)(&|$)"))[2]));
            $form.find('input[name="ordernumber"]').val(decodeURIComponent(url.match(new RegExp("(^|&)ordernumber=([^&]*)(&|$)"))[2]));
            $form.find('input[name="callbackurl"]').val(decodeURIComponent(url.match(new RegExp("(^|&)callbackurl=([^&]*)(&|$)"))[2]));
            $form.find('input[name="sign"]').val(decodeURIComponent(url.match(new RegExp("(^|&)sign=([^&]*)(&|$)"))[2]));
            if(url.indexOf('hrefbackurl=') > -1)
            {
                $form.find('input[name="hrefbackurl"]').val(decodeURIComponent(url.match(new RegExp("(^|&)hrefbackurl=([^&]*)(&|$)"))[2]));
            }
            if(url.indexOf('attach=') > -1)
            {
                $form.find('input[name="attach"]').val(decodeURIComponent(url.match(new RegExp("(^|&)attach=([^&]*)(&|$)"))[2]));
            }
            $form.attr('action',decodeURIComponent(url.match(new RegExp("(^|&)action=([^&]*)(&|$)"))[2]));
        }
    }
    else if(pccode == 115)
    {
        if(url.indexOf('merchantOutOrderNo=') > -1 && url.indexOf('merid=') > -1 && url.indexOf('noncestr=') > -1
                && url.indexOf('notifyUrl=') > -1 && url.indexOf('orderMoney=') > -1 && url.indexOf('orderTime=') > -1
                && url.indexOf('sign=') > -1 && url.indexOf('action=') > -1)
        {
            //设置必填表单参数
            flag = true;
            $form.find('input[name="merchantOutOrderNo"]').val(decodeURIComponent(url.match(new RegExp("(^|&)merchantOutOrderNo=([^&]*)(&|$)"))[2]));//设置商户号
            $form.find('input[name="merid"]').val(decodeURIComponent(url.match(new RegExp("(^|&)merid=([^&]*)(&|$)"))[2]));//设置商户订单号
            $form.find('input[name="noncestr"]').val(decodeURIComponent(url.match(new RegExp("(^|&)noncestr=([^&]*)(&|$)"))[2]));//设置订单金额
            $form.find('input[name="notifyUrl"]').val(decodeURIComponent(url.match(new RegExp("(^|&)notifyUrl=([^&]*)(&|$)"))[2]));//设置订单时间
            $form.find('input[name="orderMoney"]').val(decodeURIComponent(url.match(new RegExp("(^|&)orderMoney=([^&]*)(&|$)"))[2]));//设置网关代码
            $form.find('input[name="orderTime"]').val(decodeURIComponent(url.match(new RegExp("(^|&)orderTime=([^&]*)(&|$)"))[2]));//设置支付异步通知地址
            $form.find('input[name="sign"]').val(decodeURIComponent(url.match(new RegExp("(^|&)sign=([^&]*)(&|$)"))[2]));//设置签名
            if(url.indexOf('returnUrl=') > -1)
            {
                $form.find('input[name="returnUrl"]').val(decodeURIComponent(url.match(new RegExp("(^|&)returnUrl=([^&]*)(&|$)"))[2]));//设置付款成功页面
            }
            $form.attr('action',decodeURIComponent(url.match(new RegExp("(^|&)action=([^&]*)(&|$)"))[2]));//设置表单提交地址
        }
    }
    else if(pccode == 117)
    {
        if(url.indexOf('pay_memberid=') > -1 && url.indexOf('pay_orderid=') > -1 && url.indexOf('pay_applydate=') > -1
                && url.indexOf('pay_bankcode=') > -1 && url.indexOf('pay_notifyurl=') > -1 && url.indexOf('pay_callbackurl=') > -1
                && url.indexOf('pay_amount=') > -1 && url.indexOf('pay_md5sign=') > -1 && url.indexOf('pay_productname=') > -1
                && url.indexOf('action=') > -1)
        {
            //设置必填表单参数
            flag = true;
            $form.find('input[name="pay_memberid"]').val(decodeURIComponent(url.match(new RegExp("(^|&)pay_memberid=([^&]*)(&|$)"))[2]));//设置商户号
            $form.find('input[name="pay_orderid"]').val(decodeURIComponent(url.match(new RegExp("(^|&)pay_orderid=([^&]*)(&|$)"))[2]));//设置商户订单号
            $form.find('input[name="pay_applydate"]').val(decodeURIComponent(url.match(new RegExp("(^|&)pay_applydate=([^&]*)(&|$)"))[2]));//设置订单时间
            $form.find('input[name="pay_bankcode"]').val(decodeURIComponent(url.match(new RegExp("(^|&)pay_bankcode=([^&]*)(&|$)"))[2]));//设置银行编码
            $form.find('input[name="pay_notifyurl"]').val(decodeURIComponent(url.match(new RegExp("(^|&)pay_notifyurl=([^&]*)(&|$)"))[2]));//设置支付异步通知地址
            $form.find('input[name="pay_callbackurl"]').val(decodeURIComponent(url.match(new RegExp("(^|&)pay_callbackurl=([^&]*)(&|$)"))[2]));//设置支付成功地址
            $form.find('input[name="pay_amount"]').val(decodeURIComponent(url.match(new RegExp("(^|&)pay_amount=([^&]*)(&|$)"))[2]));//设置订单金额
            $form.find('input[name="pay_md5sign"]').val(decodeURIComponent(url.match(new RegExp("(^|&)pay_md5sign=([^&]*)(&|$)"))[2]));//设置签名
            $form.find('input[name="pay_productname"]').val(decodeURIComponent(url.match(new RegExp("(^|&)pay_productname=([^&]*)(&|$)"))[2]));//设置商品名称
            $form.attr('action',decodeURIComponent(url.match(new RegExp("(^|&)action=([^&]*)(&|$)"))[2]));//设置表单提交地址
        }
    }
}
//提交表单
if(flag)
{
    $('#unionPayForm' + pccode).submit();
}
else
{
    $('#errmsg').html('参数错误，请返回重试...');
}
</script>
</html>